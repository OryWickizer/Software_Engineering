# CI/CD for this repository

This repo has two projects:

- Client (Vite + React): `proj2/Ecobites/client`
- Server (Express + Mongoose + Jest): `proj2/Ecobites/server`

## Workflows

### 1) CI (`.github/workflows/ci.yml`)

Triggers on pushes and pull requests to `main` and `Yash`:

- Server job
  - Node 20, npm install
  - Jest tests with coverage
  - Uploads coverage as artifact: `server-coverage`

- Client job
  - Node 20, npm install
  - Lints (if script present)
  - Vitest unit tests + coverage
  - Builds production bundle
  - Uploads coverage artifact `client-coverage` and build artifact `client-dist`

These jobs serve as required checks for PRs. Configure branch protection in GitHub settings to require both jobs.

### 2) Deploy (manual) (`.github/workflows/deploy.yml`)

Runs on `workflow_dispatch` (manual trigger). It:

- Builds client (`dist/`) and uploads as artifact `client-dist-<sha>`
- Installs production server deps and zips the server under `server-<sha>.zip` and uploads it as an artifact

Optional (commented): push a server container image to GHCR if you add a Dockerfile and uncomment the steps.

## Secrets and environments

No secrets are required for the CI. For deploying to external services, add relevant secrets in the repo settings and extend the deploy workflow accordingly.

## Local parity

- Server tests: `npm test` in `proj2/Ecobites/server` (coverage on by default)
- Client tests: `npm run test -- --run` or `npm run test:coverage` in `proj2/Ecobites/client`
- Client build: `npm run build`

## Extending CD

- GHCR containerization: add a `Dockerfile` in `proj2/Ecobites/server/` then uncomment the GHCR job in `deploy.yml`.
- Cloud deploys: add jobs (e.g., Azure Web Apps, AWS Elastic Beanstalk, or Render) using official Actions and secrets.

## Notes

- Client coverage uses `@vitest/coverage-v8` (added in `devDependencies`).
- Server coverage is generated by Jest under `proj2/Ecobites/server/coverage`.
